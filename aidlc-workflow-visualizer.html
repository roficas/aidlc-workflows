<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI-DLC Workflow Visualizer</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif; background: #f5f7fa; color: #2c3e50; }
        .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
        h1 { text-align: center; margin-bottom: 30px; color: #2c3e50; font-size: 2.5em; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .header h1 { margin: 0; flex: 1; }
        .lang-selector { display: flex; gap: 10px; }
        .lang-btn { background: #ecf0f1; border: 2px solid transparent; padding: 8px 12px; border-radius: 6px; cursor: pointer; font-size: 1.5em; transition: all 0.2s; }
        .lang-btn:hover { background: #d5dbdb; }
        .lang-btn.active { background: #3498db; border-color: #2980b9; }
        .subtitle { text-align: center; color: #7f8c8d; margin-bottom: 40px; font-size: 1.1em; }
        
        /* Phase Cards */
        .phases { display: flex; gap: 20px; margin-bottom: 30px; }
        .phase { flex: 1; background: white; border-radius: 12px; padding: 30px; cursor: pointer; transition: all 0.3s; box-shadow: 0 2px 8px rgba(0,0,0,0.1); border: 3px solid transparent; }
        .phase:hover { transform: translateY(-5px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); }
        .phase.active { border-color: currentColor; box-shadow: 0 8px 25px rgba(0,0,0,0.2); }
        .phase.inception { color: #3498db; }
        .phase.construction { color: #2ecc71; }
        .phase.operations { color: #f39c12; }
        .phase-icon { font-size: 3em; margin-bottom: 15px; }
        .phase-title { font-size: 1.5em; font-weight: bold; margin-bottom: 10px; }
        .phase-desc { color: #7f8c8d; font-size: 0.95em; line-height: 1.5; }
        
        /* Stages Section */
        .stages-container { background: white; border-radius: 12px; padding: 30px; margin-bottom: 30px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: none; }
        .stages-container.show { display: block; animation: fadeIn 0.3s; }
        .stages-title { font-size: 1.8em; margin-bottom: 20px; color: #2c3e50; }
        .stages-grid-title { font-size: 0.9em; margin: 25px 0 12px 0; color: #7f8c8d; text-align: center; }
        .stages { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
        .stage { background: #f8f9fa; border-left: 4px solid #3498db; padding: 20px; border-radius: 8px; cursor: pointer; transition: all 0.2s; }
        .stage:hover { background: #e8f4f8; transform: translateX(5px); }
        .stage.active { background: #d4edff; border-left-width: 6px; }
        .stage.conditional { opacity: 0.7; }
        .stage-name { font-weight: bold; font-size: 1.1em; margin-bottom: 8px; }
        .stage-badge { display: inline-block; padding: 3px 10px; border-radius: 12px; font-size: 0.75em; font-weight: bold; margin-bottom: 8px; }
        .badge-always { background: #2ecc71; color: white; }
        .badge-conditional { background: #f39c12; color: white; }
        .stage-summary { font-size: 0.9em; color: #555; line-height: 1.4; }
        
        /* Details Panel */
        .details-panel { background: white; border-radius: 12px; padding: 40px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: none; }
        .details-panel.show { display: block; animation: fadeIn 0.3s; }
        .details-header { border-bottom: 3px solid #3498db; padding-bottom: 20px; margin-bottom: 30px; }
        .details-title { font-size: 2em; color: #2c3e50; margin-bottom: 10px; }
        .details-meta { display: flex; gap: 15px; flex-wrap: wrap; }
        .meta-item { padding: 8px 15px; background: #ecf0f1; border-radius: 6px; font-size: 0.9em; }
        .section { margin-bottom: 35px; }
        .section-title { font-size: 1.4em; color: #2c3e50; margin-bottom: 15px; padding-left: 15px; border-left: 4px solid #3498db; }
        .section-content { line-height: 1.8; color: #34495e; }
        .section-content ul { margin-left: 25px; margin-top: 10px; }
        .section-content li { margin-bottom: 8px; }
        .example-box { background: #f8f9fa; border-left: 4px solid #3498db; padding: 20px; border-radius: 6px; margin-top: 15px; }
        .example-title { font-weight: bold; color: #2c3e50; margin-bottom: 10px; }
        .code-block { background: #2c3e50; color: #ecf0f1; padding: 15px; border-radius: 6px; font-family: 'Courier New', monospace; font-size: 0.9em; overflow-x: auto; margin-top: 10px; }
        
        /* Flow Diagram */
        .flow-diagram { background: #f8f9fa; border-radius: 8px; padding: 25px; margin-bottom: 30px; }
        .flow-title { font-weight: bold; color: #2c3e50; margin-bottom: 15px; font-size: 1.1em; text-align: center; }
        .flow-desc { color: #555; text-align: center; margin-bottom: 25px; font-size: 0.95em; }
        .flow-horizontal { display: flex; align-items: center; gap: 10px; overflow-x: auto; padding: 10px 0; }
        .flow-step { background: white; border: 2px solid #3498db; border-radius: 8px; padding: 12px 16px; min-width: 140px; text-align: center; flex-shrink: 0; }
        .flow-step-title { font-weight: bold; color: #2c3e50; margin-bottom: 5px; font-size: 0.9em; }
        .flow-step-desc { font-size: 0.8em; color: #666; }
        .flow-arrow { font-size: 1.5em; color: #3498db; flex-shrink: 0; }
        .flow-loop { border: 3px dashed #2ecc71; background: #f0fdf4; padding: 20px; border-radius: 8px; margin: 15px 0; position: relative; }
        .flow-loop-label { position: absolute; top: -12px; left: 20px; background: #2ecc71; color: white; padding: 4px 12px; border-radius: 12px; font-size: 0.85em; font-weight: bold; }
        .flow-unit { background: #e8f5e9; border-left: 4px solid #2ecc71; padding: 12px; margin-bottom: 15px; border-radius: 4px; }
        .flow-unit-title { font-weight: bold; color: #2ecc71; font-size: 0.95em; }
        .flow-repeat { text-align: center; margin: 15px 0; color: #2ecc71; font-weight: bold; font-size: 0.95em; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .back-btn { background: #3498db; color: white; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-size: 1em; margin-bottom: 20px; transition: background 0.2s; }
        .back-btn:hover { background: #2980b9; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="width: 150px;"></div>
            <h1>üöÄ AI-DLC Workflow Visualizer</h1>
            <div class="lang-selector">
                <button class="lang-btn active" onclick="setLanguage('en')" title="English">üá∫üá∏</button>
                <button class="lang-btn" onclick="setLanguage('es')" title="Espa√±ol">üá™üá∏</button>
                <button class="lang-btn" onclick="setLanguage('pt')" title="Portugu√™s">üáßüá∑</button>
            </div>
        </div>
        <p class="subtitle" id="subtitle">Interactive visualization of the AI-Driven Development Life Cycle</p>
        
        <!-- Phase Selection -->
        <div class="phases">
            <div class="phase inception" onclick="showPhase('inception')">
                <div class="phase-icon">üîµ</div>
                <div class="phase-title">INCEPTION</div>
                <div class="phase-desc">Planning, requirements gathering, and architectural decisions. Determines WHAT to build and WHY.</div>
            </div>
            <div class="phase construction" onclick="showPhase('construction')">
                <div class="phase-icon">üü¢</div>
                <div class="phase-title">CONSTRUCTION</div>
                <div class="phase-desc">Detailed design, NFR implementation, and code generation. Determines HOW to build it.</div>
            </div>
            <div class="phase operations" onclick="showPhase('operations')">
                <div class="phase-icon">üü°</div>
                <div class="phase-title">OPERATIONS</div>
                <div class="phase-desc">Deployment and monitoring (placeholder for future expansion).</div>
            </div>
        </div>
        
        <!-- Stages Container -->
        <div id="stages-container" class="stages-container">
            <h2 class="stages-title" id="stages-title"></h2>
            <div id="flow-diagram-container"></div>
            <div id="stages" class="stages"></div>
        </div>
        
        <!-- Details Panel -->
        <div id="details-panel" class="details-panel">
            <button class="back-btn" onclick="backToStages()">‚Üê Back to Stages</button>
            <div id="details-content"></div>
        </div>
    </div>

    <script>
        let currentLanguage = 'en';
        
        const translations = {
            en: {
                subtitle: "Interactive visualization of the AI-Driven Development Life Cycle",
                inception: { title: "INCEPTION", desc: "Planning, requirements gathering, and architectural decisions. Determines WHAT to build and WHY." },
                construction: { title: "CONSTRUCTION", desc: "Detailed design, NFR implementation, and code generation. Determines HOW to build it." },
                operations: { title: "OPERATIONS", desc: "Deployment and monitoring (placeholder for future expansion)." },
                clickStage: "üìë Click on any stage below for detailed information",
                backBtn: "‚Üê Back to Stages",
                flowSequential: "üìä Execution Flow: Sequential",
                flowLoop: "üîÑ Execution Flow: Per-Unit Loop",
                flowPlaceholder: "üöß Execution Flow: Placeholder",
                forEachUnit: "üîÅ FOR EACH UNIT",
                exampleUnit: "Example Unit: \"User Authentication Service\"",
                implementsStories: "Implements stories: Login, Logout, Password Reset, Session Management",
                repeatUnit: "‚Üª Repeat for next unit (e.g., \"Payment Processing Service\")",
                afterUnits: "After all units complete",
                always: "ALWAYS",
                conditional: "CONDITIONAL",
                placeholder: "PLACEHOLDER",
                ifNeeded: "If needed",
                ifBrownfield: "If brownfield",
                notImplemented: "Not yet implemented",
                sectionDescription: "üìã Description",
                sectionPurpose: "üéØ Purpose",
                sectionCriteria: "‚öôÔ∏è Execution Criteria",
                sectionQuestions: "‚ùì Example Questions",
                sectionOutputs: "üì¶ Outputs & Artifacts",
                sectionUnitStory: "üîó Unit-Story Relationship",
                noteFileLocations: "üí° Note on File Locations",
                noteFileLocationsText: "All documentation artifacts are stored in aidlc-docs/ directory, organized by phase and stage. Application code is always generated in the workspace root, never inside aidlc-docs/.",
                exampleUnitStoryTitle: "Example: Unit-Story Mapping",
                exampleUnitStoryUnit: "Unit:",
                exampleUnitStoryImplements: "Implements Stories:",
                phaseLabel: "Phase:"
            },
            es: {
                subtitle: "Visualizaci√≥n interactiva del Ciclo de Vida de Desarrollo Impulsado por IA",
                inception: { title: "INICIO", desc: "Planificaci√≥n, recopilaci√≥n de requisitos y decisiones arquitect√≥nicas. Determina QU√â construir y POR QU√â." },
                construction: { title: "CONSTRUCCI√ìN", desc: "Dise√±o detallado, implementaci√≥n de RNF y generaci√≥n de c√≥digo. Determina C√ìMO construirlo." },
                operations: { title: "OPERACIONES", desc: "Despliegue y monitoreo (marcador de posici√≥n para expansi√≥n futura)." },
                clickStage: "üìë Haga clic en cualquier etapa a continuaci√≥n para obtener informaci√≥n detallada",
                backBtn: "‚Üê Volver a Etapas",
                flowSequential: "üìä Flujo de Ejecuci√≥n: Secuencial",
                flowLoop: "üîÑ Flujo de Ejecuci√≥n: Bucle por Unidad",
                flowPlaceholder: "üöß Flujo de Ejecuci√≥n: Marcador de Posici√≥n",
                forEachUnit: "üîÅ PARA CADA UNIDAD",
                exampleUnit: "Unidad de Ejemplo: \"Servicio de Autenticaci√≥n de Usuario\"",
                implementsStories: "Implementa historias: Inicio de sesi√≥n, Cierre de sesi√≥n, Restablecimiento de contrase√±a, Gesti√≥n de sesiones",
                repeatUnit: "‚Üª Repetir para la siguiente unidad (ej., \"Servicio de Procesamiento de Pagos\")",
                afterUnits: "Despu√©s de completar todas las unidades",
                always: "SIEMPRE",
                conditional: "CONDICIONAL",
                placeholder: "MARCADOR",
                ifNeeded: "Si es necesario",
                ifBrownfield: "Si es brownfield",
                notImplemented: "A√∫n no implementado",
                sectionDescription: "üìã Descripci√≥n",
                sectionPurpose: "üéØ Prop√≥sito",
                sectionCriteria: "‚öôÔ∏è Criterios de Ejecuci√≥n",
                sectionQuestions: "‚ùì Preguntas de Ejemplo",
                sectionOutputs: "üì¶ Salidas y Artefactos",
                sectionUnitStory: "üîó Relaci√≥n Unidad-Historia",
                noteFileLocations: "üí° Nota sobre Ubicaciones de Archivos",
                noteFileLocationsText: "Todos los artefactos de documentaci√≥n se almacenan en el directorio aidlc-docs/, organizados por fase y etapa. El c√≥digo de la aplicaci√≥n siempre se genera en la ra√≠z del espacio de trabajo, nunca dentro de aidlc-docs/.",
                exampleUnitStoryTitle: "Ejemplo: Mapeo Unidad-Historia",
                exampleUnitStoryUnit: "Unidad:",
                exampleUnitStoryImplements: "Implementa Historias:",
                phaseLabel: "Fase:"
            },
            pt: {
                subtitle: "Visualiza√ß√£o interativa do Ciclo de Vida de Desenvolvimento Orientado por IA",
                inception: { title: "IN√çCIO", desc: "Planejamento, coleta de requisitos e decis√µes arquiteturais. Determina O QUE construir e POR QU√ä." },
                construction: { title: "CONSTRU√á√ÉO", desc: "Design detalhado, implementa√ß√£o de RNF e gera√ß√£o de c√≥digo. Determina COMO construir." },
                operations: { title: "OPERA√á√ïES", desc: "Implanta√ß√£o e monitoramento (espa√ßo reservado para expans√£o futura)." },
                clickStage: "üìë Clique em qualquer etapa abaixo para informa√ß√µes detalhadas",
                backBtn: "‚Üê Voltar para Etapas",
                flowSequential: "üìä Fluxo de Execu√ß√£o: Sequencial",
                flowLoop: "üîÑ Fluxo de Execu√ß√£o: Loop por Unidade",
                flowPlaceholder: "üöß Fluxo de Execu√ß√£o: Espa√ßo Reservado",
                forEachUnit: "üîÅ PARA CADA UNIDADE",
                exampleUnit: "Unidade de Exemplo: \"Servi√ßo de Autentica√ß√£o de Usu√°rio\"",
                implementsStories: "Implementa hist√≥rias: Login, Logout, Redefini√ß√£o de senha, Gerenciamento de sess√£o",
                repeatUnit: "‚Üª Repetir para a pr√≥xima unidade (ex., \"Servi√ßo de Processamento de Pagamento\")",
                afterUnits: "Ap√≥s todas as unidades serem conclu√≠das",
                always: "SEMPRE",
                conditional: "CONDICIONAL",
                placeholder: "ESPA√áO RESERVADO",
                ifNeeded: "Se necess√°rio",
                ifBrownfield: "Se brownfield",
                notImplemented: "Ainda n√£o implementado",
                sectionDescription: "üìã Descri√ß√£o",
                sectionPurpose: "üéØ Prop√≥sito",
                sectionCriteria: "‚öôÔ∏è Crit√©rios de Execu√ß√£o",
                sectionQuestions: "‚ùì Perguntas de Exemplo",
                sectionOutputs: "üì¶ Sa√≠das e Artefatos",
                sectionUnitStory: "üîó Rela√ß√£o Unidade-Hist√≥ria",
                noteFileLocations: "üí° Nota sobre Localiza√ß√µes de Arquivos",
                noteFileLocationsText: "Todos os artefatos de documenta√ß√£o s√£o armazenados no diret√≥rio aidlc-docs/, organizados por fase e etapa. O c√≥digo da aplica√ß√£o √© sempre gerado na raiz do espa√ßo de trabalho, nunca dentro de aidlc-docs/.",
                exampleUnitStoryTitle: "Exemplo: Mapeamento Unidade-Hist√≥ria",
                exampleUnitStoryUnit: "Unidade:",
                exampleUnitStoryImplements: "Implementa Hist√≥rias:",
                phaseLabel: "Fase:"
            }
        };

        function setLanguage(lang) {
            currentLanguage = lang;
            workflow = workflowData[lang];
            document.querySelectorAll('.lang-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            // Update subtitle
            document.getElementById('subtitle').textContent = translations[lang].subtitle;
            
            // Update phase cards
            document.querySelector('.phase.inception .phase-title').textContent = translations[lang].inception.title;
            document.querySelector('.phase.inception .phase-desc').textContent = translations[lang].inception.desc;
            document.querySelector('.phase.construction .phase-title').textContent = translations[lang].construction.title;
            document.querySelector('.phase.construction .phase-desc').textContent = translations[lang].construction.desc;
            document.querySelector('.phase.operations .phase-title').textContent = translations[lang].operations.title;
            document.querySelector('.phase.operations .phase-desc').textContent = translations[lang].operations.desc;
            
            // Refresh current phase if one is selected
            if (currentPhase) {
                const wasShowingDetails = document.getElementById('details-panel').classList.contains('show');
                const currentStageKey = currentStage;
                
                showPhase(currentPhase);
                
                // If we were showing stage details, re-show them
                if (wasShowingDetails && currentStageKey) {
                    // Find the stage element and trigger click
                    const stageElements = document.querySelectorAll('.stage');
                    stageElements.forEach(el => {
                        if (el.querySelector('.stage-name').textContent === workflow[currentPhase].stages[currentStageKey].name) {
                            el.click();
                        }
                    });
                }
            }
        }

        const workflowData = {
            en: {
                inception: {
                    title: "INCEPTION PHASE",
                    color: "#3498db",
                    flow: "sequential",
                    flowDescription: "All stages execute sequentially, one after another. Each stage must complete before the next begins.",
                    stages: {
                        "workspace-detection": {
                            name: "Workspace Detection",
                            type: "always",
                            description: "Detects whether the project is greenfield (new) or brownfield (existing codebase). Checks for existing AI-DLC artifacts and determines the starting point.",
                            purpose: "Establish project context and determine workflow entry point",
                            executes: "Always - First stage of every workflow",
                            questions: [
                                "Is there existing code in the workspace?",
                                "Are there previous AI-DLC artifacts (aidlc-state.md)?",
                                "What is the project structure and technology stack?"
                            ],
                            outputs: [
                                "Project type classification (greenfield/brownfield)",
                                "Workspace scan results",
                                "Initial audit.md entry with user request",
                                "Decision on next phase (Reverse Engineering or Requirements Analysis)"
                            ]
                        },
                        "reverse-engineering": {
                            name: "Reverse Engineering",
                            type: "conditional",
                            description: "Analyzes existing codebase to understand architecture, components, APIs, and technology stack. Only runs for brownfield projects without existing reverse engineering artifacts.",
                            purpose: "Document existing system before making changes",
                            executes: "Only if: Brownfield project AND no previous reverse engineering artifacts exist",
                            questions: [
                                "What are the main business transactions?",
                                "What components and packages exist?",
                                "How do components interact?",
                                "What APIs are exposed?",
                                "What is the technology stack?"
                            ],
                            outputs: [
                                "architecture.md - System architecture overview",
                                "business-overview.md - Business transactions",
                                "code-structure.md - Code organization",
                                "api-documentation.md - API endpoints",
                                "component-inventory.md - Component catalog",
                                "interaction-diagrams.md - Component interactions",
                                "technology-stack.md - Tech stack details",
                                "dependencies.md - Dependency graph"
                            ]
                        },
                        "requirements-analysis": {
                            name: "Requirements Analysis",
                            type: "always",
                            description: "Analyzes user intent and gathers functional and non-functional requirements. Depth adapts based on request clarity and complexity (minimal/standard/comprehensive).",
                            purpose: "Understand and document what needs to be built",
                            executes: "Always - Adaptive depth based on complexity",
                            questions: [
                                "What is the user trying to achieve?",
                                "What are the functional requirements?",
                                "What are the non-functional requirements (performance, security, scalability)?",
                                "What are the acceptance criteria?",
                                "What are the constraints and assumptions?"
                            ],
                            outputs: [
                                "requirement-verification-questions.md - Clarifying questions",
                                "requirements.md - Documented requirements",
                                "intent-analysis.md - User intent breakdown",
                                "Updated audit.md with user responses"
                            ]
                        },
                        "user-stories": {
                            name: "User Stories",
                            type: "conditional",
                            description: "Creates user stories and personas when there's user-facing functionality or complex business requirements. Uses multi-factor analysis to determine if stories add value.",
                            purpose: "Define user-centric requirements and acceptance criteria",
                            executes: "If: User-facing features, complex business logic, or multiple user types involved",
                            questions: [
                                "Who are the users/personas?",
                                "What are their goals and pain points?",
                                "What user journeys need to be supported?",
                                "What are the acceptance criteria for each story?",
                                "What is the priority of each story?"
                            ],
                            outputs: [
                                "user-story-plan.md - Story planning document",
                                "personas.md - User personas",
                                "user-stories.md - Complete user stories with acceptance criteria",
                                "story-map.md - Story mapping and prioritization"
                            ]
                        },
                        "workflow-planning": {
                            name: "Workflow Planning",
                            type: "always",
                            description: "Determines which phases and stages will execute, at what depth level, and in what sequence. Creates a visual workflow plan for user approval.",
                            purpose: "Plan the execution strategy and get user approval",
                            executes: "Always - Critical decision point",
                            questions: [
                                "Which Construction stages are needed?",
                                "What depth level for each stage (minimal/standard/comprehensive)?",
                                "For brownfield: Which packages to change and in what order?",
                                "What is the overall execution strategy?"
                            ],
                            outputs: [
                                "workflow-plan.md - Execution plan with rationale",
                                "workflow-visualization.md - Mermaid diagram of planned workflow",
                                "Updated aidlc-state.md with planned stages"
                            ]
                        },
                        "application-design": {
                            name: "Application Design",
                            type: "conditional",
                            description: "Designs new components, services, methods, and business rules. Defines component boundaries and dependencies.",
                            purpose: "Design the application architecture and component structure",
                            executes: "If: New components needed OR component methods need definition OR service layer design required",
                            questions: [
                                "What components/services are needed?",
                                "What are the component responsibilities?",
                                "What methods does each component expose?",
                                "What are the component dependencies?",
                                "What business rules need to be implemented?"
                            ],
                            outputs: [
                                "component-design.md - Component specifications",
                                "service-design.md - Service layer design",
                                "business-rules.md - Business logic definitions",
                                "component-diagram.md - Visual component relationships"
                            ]
                        },
                        "units-generation": {
                            name: "Units Generation",
                            type: "conditional",
                            description: "Decomposes the system into multiple units of work for parallel development. Each unit is a cohesive piece that can be developed independently.",
                            purpose: "Break down complex systems into manageable units",
                            executes: "If: Multiple services/modules needed OR complex system requiring structured breakdown",
                            questions: [
                                "How should the system be decomposed?",
                                "What are the unit boundaries?",
                                "What are the dependencies between units?",
                                "What stories/requirements does each unit implement?",
                                "What is the development sequence?"
                            ],
                            outputs: [
                                "units-plan.md - Unit decomposition strategy",
                                "unit-definitions.md - Detailed unit specifications",
                                "unit-dependencies.md - Dependency graph",
                                "unit-story-map.md - Story-to-unit mapping"
                            ]
                        }
                    }
                },
                construction: {
                    title: "CONSTRUCTION PHASE",
                    color: "#2ecc71",
                    flow: "per-unit-loop",
                    flowDescription: "Executes in a per-unit loop. Each unit (which implements a group of user stories) goes through all design stages and code generation before moving to the next unit. After all units complete, Build and Test runs once.",
                    stages: {
                        "functional-design": {
                            name: "Functional Design",
                            type: "conditional",
                            description: "Designs data models, schemas, and detailed business logic for each unit. Executed per-unit in the construction loop.",
                            purpose: "Define the detailed functional implementation",
                            executes: "Per-unit, if: New data models OR complex business logic OR business rules need detailed design",
                            questions: [
                                "What data models are needed?",
                                "What are the entity relationships?",
                                "What business logic needs to be implemented?",
                                "What are the validation rules?",
                                "What are the data transformation requirements?"
                            ],
                            outputs: [
                                "{unit-name}/functional-design/data-models.md",
                                "{unit-name}/functional-design/business-logic.md",
                                "{unit-name}/functional-design/validation-rules.md",
                                "{unit-name}/functional-design/design-decisions.md"
                            ]
                        },
                        "nfr-requirements": {
                            name: "NFR Requirements",
                            type: "conditional",
                            description: "Assesses non-functional requirements including performance, security, scalability, and technology stack selection for each unit.",
                            purpose: "Identify quality attributes and constraints",
                            executes: "Per-unit, if: Performance requirements OR security considerations OR scalability concerns OR tech stack selection needed",
                            questions: [
                                "What are the performance requirements (latency, throughput)?",
                                "What security requirements exist?",
                                "What scalability needs are there?",
                                "What technology stack should be used?",
                                "What are the reliability requirements?"
                            ],
                            outputs: [
                                "{unit-name}/nfr-requirements/performance-requirements.md",
                                "{unit-name}/nfr-requirements/security-requirements.md",
                                "{unit-name}/nfr-requirements/scalability-requirements.md",
                                "{unit-name}/nfr-requirements/tech-stack-selection.md"
                            ]
                        },
                        "nfr-design": {
                            name: "NFR Design",
                            type: "conditional",
                            description: "Designs patterns and solutions to meet non-functional requirements. Only executes if NFR Requirements was executed.",
                            purpose: "Design solutions for quality attributes",
                            executes: "Per-unit, if: NFR Requirements was executed",
                            questions: [
                                "What patterns address the performance requirements?",
                                "How will security be implemented?",
                                "What caching strategy should be used?",
                                "How will the system scale?",
                                "What monitoring and observability is needed?"
                            ],
                            outputs: [
                                "{unit-name}/nfr-design/performance-patterns.md",
                                "{unit-name}/nfr-design/security-design.md",
                                "{unit-name}/nfr-design/scalability-design.md",
                                "{unit-name}/nfr-design/monitoring-design.md"
                            ]
                        },
                        "infrastructure-design": {
                            name: "Infrastructure Design",
                            type: "conditional",
                            description: "Maps infrastructure services, defines deployment architecture, and specifies cloud resources needed for each unit.",
                            purpose: "Design the infrastructure and deployment strategy",
                            executes: "Per-unit, if: Infrastructure services need mapping OR deployment architecture required OR cloud resources need specification",
                            questions: [
                                "What cloud services are needed?",
                                "What is the deployment architecture?",
                                "What infrastructure as code is required?",
                                "What networking and security groups are needed?",
                                "What is the disaster recovery strategy?"
                            ],
                            outputs: [
                                "{unit-name}/infrastructure-design/cloud-services.md",
                                "{unit-name}/infrastructure-design/deployment-architecture.md",
                                "{unit-name}/infrastructure-design/iac-specifications.md",
                                "{unit-name}/infrastructure-design/network-design.md"
                            ]
                        },
                        "code-generation": {
                            name: "Code Generation",
                            type: "always",
                            description: "Generates actual code, tests, and artifacts for each unit. Two-part process: Planning (create detailed plan) and Generation (execute plan to generate code).",
                            purpose: "Generate working code and tests",
                            executes: "Always - Per-unit, for every unit of work",
                            unitContext: "Each unit implements a cohesive group of user stories. The code generation reads the unit-story-map to understand which stories this unit implements and generates code to fulfill those stories.",
                            questions: [
                                "What code needs to be generated?",
                                "What is the project structure?",
                                "What tests are needed?",
                                "What documentation should be created?",
                                "What deployment artifacts are required?"
                            ],
                            outputs: [
                                "plans/{unit-name}-code-generation-plan.md",
                                "Application code in workspace root (NOT in aidlc-docs/)",
                                "Unit tests",
                                "Integration tests",
                                "{unit-name}/code/code-summary.md",
                                "API documentation",
                                "Database migration scripts",
                                "Deployment artifacts"
                            ]
                        },
                        "build-and-test": {
                            name: "Build and Test",
                            type: "always",
                            description: "Creates comprehensive build and test instructions for all units. Includes unit tests, integration tests, and performance tests.",
                            purpose: "Provide complete testing and validation strategy",
                            executes: "Always - After all units are complete",
                            questions: [
                                "How should the application be built?",
                                "What unit tests need to run?",
                                "What integration tests are needed?",
                                "What performance tests should be executed?",
                                "What is the test execution sequence?"
                            ],
                            outputs: [
                                "build-and-test/build-instructions.md",
                                "build-and-test/unit-test-instructions.md",
                                "build-and-test/integration-test-instructions.md",
                                "build-and-test/performance-test-instructions.md",
                                "build-and-test/build-and-test-summary.md"
                            ]
                        }
                    }
                },
                operations: {
                    title: "OPERATIONS PHASE",
                    color: "#f39c12",
                    flow: "placeholder",
                    flowDescription: "Future expansion - will include deployment, monitoring, and operational workflows.",
                    stages: {
                        "operations": {
                            name: "Operations",
                            type: "placeholder",
                            description: "Placeholder for future deployment and monitoring workflows. Will eventually include deployment planning, monitoring setup, incident response, and production readiness.",
                            purpose: "Deploy and operate the system (future expansion)",
                            executes: "Not yet implemented - Placeholder",
                            questions: [
                                "How should the application be deployed?",
                                "What monitoring and observability is needed?",
                                "What is the incident response procedure?",
                                "What maintenance activities are required?",
                                "What are the production readiness criteria?"
                            ],
                            outputs: [
                                "Future: Deployment plans",
                                "Future: Monitoring configurations",
                                "Future: Runbooks and procedures",
                                "Future: Production readiness checklists"
                            ]
                        }
                    }
                }
            },
            es: {
                inception: {
                    title: "FASE DE INICIO",
                    color: "#3498db",
                    flow: "sequential",
                    flowDescription: "Todas las etapas se ejecutan secuencialmente, una tras otra. Cada etapa debe completarse antes de que comience la siguiente.",
                    stages: {
                        "workspace-detection": {
                            name: "Detecci√≥n de Espacio de Trabajo",
                            type: "always",
                            description: "Detecta si el proyecto es greenfield (nuevo) o brownfield (c√≥digo base existente). Verifica artefactos AI-DLC existentes y determina el punto de partida.",
                            purpose: "Establecer el contexto del proyecto y determinar el punto de entrada del flujo de trabajo",
                            executes: "Siempre - Primera etapa de cada flujo de trabajo",
                            questions: [
                                "¬øExiste c√≥digo en el espacio de trabajo?",
                                "¬øHay artefactos AI-DLC previos (aidlc-state.md)?",
                                "¬øCu√°l es la estructura del proyecto y la pila tecnol√≥gica?"
                            ],
                            outputs: [
                                "Clasificaci√≥n del tipo de proyecto (greenfield/brownfield)",
                                "Resultados del escaneo del espacio de trabajo",
                                "Entrada inicial de audit.md con solicitud del usuario",
                                "Decisi√≥n sobre la siguiente fase (Ingenier√≠a Inversa o An√°lisis de Requisitos)"
                            ]
                        },
                        "reverse-engineering": {
                            name: "Ingenier√≠a Inversa",
                            type: "conditional",
                            description: "Analiza el c√≥digo base existente para comprender la arquitectura, componentes, APIs y pila tecnol√≥gica. Solo se ejecuta para proyectos brownfield sin artefactos de ingenier√≠a inversa existentes.",
                            purpose: "Documentar el sistema existente antes de realizar cambios",
                            executes: "Solo si: Proyecto brownfield Y no existen artefactos de ingenier√≠a inversa previos",
                            questions: [
                                "¬øCu√°les son las principales transacciones comerciales?",
                                "¬øQu√© componentes y paquetes existen?",
                                "¬øC√≥mo interact√∫an los componentes?",
                                "¬øQu√© APIs est√°n expuestas?",
                                "¬øCu√°l es la pila tecnol√≥gica?"
                            ],
                            outputs: [
                                "architecture.md - Descripci√≥n general de la arquitectura del sistema",
                                "business-overview.md - Transacciones comerciales",
                                "code-structure.md - Organizaci√≥n del c√≥digo",
                                "api-documentation.md - Endpoints de API",
                                "component-inventory.md - Cat√°logo de componentes",
                                "interaction-diagrams.md - Interacciones de componentes",
                                "technology-stack.md - Detalles de la pila tecnol√≥gica",
                                "dependencies.md - Gr√°fico de dependencias"
                            ]
                        },
                        "requirements-analysis": {
                            name: "An√°lisis de Requisitos",
                            type: "always",
                            description: "Analiza la intenci√≥n del usuario y recopila requisitos funcionales y no funcionales. La profundidad se adapta seg√∫n la claridad y complejidad de la solicitud (m√≠nima/est√°ndar/completa).",
                            purpose: "Comprender y documentar lo que se necesita construir",
                            executes: "Siempre - Profundidad adaptativa seg√∫n la complejidad",
                            questions: [
                                "¬øQu√© est√° tratando de lograr el usuario?",
                                "¬øCu√°les son los requisitos funcionales?",
                                "¬øCu√°les son los requisitos no funcionales (rendimiento, seguridad, escalabilidad)?",
                                "¬øCu√°les son los criterios de aceptaci√≥n?",
                                "¬øCu√°les son las restricciones y suposiciones?"
                            ],
                            outputs: [
                                "requirement-verification-questions.md - Preguntas aclaratorias",
                                "requirements.md - Requisitos documentados",
                                "intent-analysis.md - Desglose de la intenci√≥n del usuario",
                                "audit.md actualizado con respuestas del usuario"
                            ]
                        },
                        "user-stories": {
                            name: "Historias de Usuario",
                            type: "conditional",
                            description: "Crea historias de usuario y personas cuando hay funcionalidad orientada al usuario o requisitos comerciales complejos. Utiliza an√°lisis multifactorial para determinar si las historias agregan valor.",
                            purpose: "Definir requisitos centrados en el usuario y criterios de aceptaci√≥n",
                            executes: "Si: Caracter√≠sticas orientadas al usuario, l√≥gica comercial compleja o m√∫ltiples tipos de usuarios involucrados",
                            questions: [
                                "¬øQui√©nes son los usuarios/personas?",
                                "¬øCu√°les son sus objetivos y puntos de dolor?",
                                "¬øQu√© viajes de usuario deben ser compatibles?",
                                "¬øCu√°les son los criterios de aceptaci√≥n para cada historia?",
                                "¬øCu√°l es la prioridad de cada historia?"
                            ],
                            outputs: [
                                "user-story-plan.md - Documento de planificaci√≥n de historias",
                                "personas.md - Personas de usuario",
                                "user-stories.md - Historias de usuario completas con criterios de aceptaci√≥n",
                                "story-map.md - Mapeo y priorizaci√≥n de historias"
                            ]
                        },
                        "workflow-planning": {
                            name: "Planificaci√≥n del Flujo de Trabajo",
                            type: "always",
                            description: "Determina qu√© fases y etapas se ejecutar√°n, a qu√© nivel de profundidad y en qu√© secuencia. Crea un plan de flujo de trabajo visual para la aprobaci√≥n del usuario.",
                            purpose: "Planificar la estrategia de ejecuci√≥n y obtener la aprobaci√≥n del usuario",
                            executes: "Siempre - Punto de decisi√≥n cr√≠tico",
                            questions: [
                                "¬øQu√© etapas de Construcci√≥n se necesitan?",
                                "¬øQu√© nivel de profundidad para cada etapa (m√≠nima/est√°ndar/completa)?",
                                "Para brownfield: ¬øQu√© paquetes cambiar y en qu√© orden?",
                                "¬øCu√°l es la estrategia de ejecuci√≥n general?"
                            ],
                            outputs: [
                                "workflow-plan.md - Plan de ejecuci√≥n con justificaci√≥n",
                                "workflow-visualization.md - Diagrama Mermaid del flujo de trabajo planificado",
                                "aidlc-state.md actualizado con etapas planificadas"
                            ]
                        },
                        "application-design": {
                            name: "Dise√±o de Aplicaci√≥n",
                            type: "conditional",
                            description: "Dise√±a nuevos componentes, servicios, m√©todos y reglas comerciales. Define l√≠mites y dependencias de componentes.",
                            purpose: "Dise√±ar la arquitectura de la aplicaci√≥n y la estructura de componentes",
                            executes: "Si: Se necesitan nuevos componentes O los m√©todos de componentes necesitan definici√≥n O se requiere dise√±o de capa de servicio",
                            questions: [
                                "¬øQu√© componentes/servicios se necesitan?",
                                "¬øCu√°les son las responsabilidades de los componentes?",
                                "¬øQu√© m√©todos expone cada componente?",
                                "¬øCu√°les son las dependencias de los componentes?",
                                "¬øQu√© reglas comerciales deben implementarse?"
                            ],
                            outputs: [
                                "component-design.md - Especificaciones de componentes",
                                "service-design.md - Dise√±o de capa de servicio",
                                "business-rules.md - Definiciones de l√≥gica comercial",
                                "component-diagram.md - Relaciones visuales de componentes"
                            ]
                        },
                        "units-generation": {
                            name: "Generaci√≥n de Unidades",
                            type: "conditional",
                            description: "Descompone el sistema en m√∫ltiples unidades de trabajo para desarrollo paralelo. Cada unidad es una pieza cohesiva que puede desarrollarse de forma independiente.",
                            purpose: "Dividir sistemas complejos en unidades manejables",
                            executes: "Si: Se necesitan m√∫ltiples servicios/m√≥dulos O sistema complejo que requiere desglose estructurado",
                            questions: [
                                "¬øC√≥mo debe descomponerse el sistema?",
                                "¬øCu√°les son los l√≠mites de las unidades?",
                                "¬øCu√°les son las dependencias entre unidades?",
                                "¬øQu√© historias/requisitos implementa cada unidad?",
                                "¬øCu√°l es la secuencia de desarrollo?"
                            ],
                            outputs: [
                                "units-plan.md - Estrategia de descomposici√≥n de unidades",
                                "unit-definitions.md - Especificaciones detalladas de unidades",
                                "unit-dependencies.md - Gr√°fico de dependencias",
                                "unit-story-map.md - Mapeo de historia a unidad"
                            ]
                        }
                    }
                },
                construction: {
                    title: "FASE DE CONSTRUCCI√ìN",
                    color: "#2ecc71",
                    flow: "per-unit-loop",
                    flowDescription: "Se ejecuta en un bucle por unidad. Cada unidad (que implementa un grupo de historias de usuario) pasa por todas las etapas de dise√±o y generaci√≥n de c√≥digo antes de pasar a la siguiente unidad. Despu√©s de que se completen todas las unidades, Build and Test se ejecuta una vez.",
                    stages: {
                        "functional-design": {
                            name: "Dise√±o Funcional",
                            type: "conditional",
                            description: "Dise√±a modelos de datos, esquemas y l√≥gica comercial detallada para cada unidad. Se ejecuta por unidad en el bucle de construcci√≥n.",
                            purpose: "Definir la implementaci√≥n funcional detallada",
                            executes: "Por unidad, si: Se necesitan nuevos modelos de datos O l√≥gica comercial compleja O las reglas comerciales necesitan dise√±o detallado",
                            questions: [
                                "¬øQu√© modelos de datos se necesitan?",
                                "¬øCu√°les son las relaciones de entidad?",
                                "¬øQu√© l√≥gica comercial debe implementarse?",
                                "¬øCu√°les son las reglas de validaci√≥n?",
                                "¬øCu√°les son los requisitos de transformaci√≥n de datos?"
                            ],
                            outputs: [
                                "{unit-name}/functional-design/data-models.md",
                                "{unit-name}/functional-design/business-logic.md",
                                "{unit-name}/functional-design/validation-rules.md",
                                "{unit-name}/functional-design/design-decisions.md"
                            ]
                        },
                        "nfr-requirements": {
                            name: "Requisitos RNF",
                            type: "conditional",
                            description: "Eval√∫a requisitos no funcionales incluyendo rendimiento, seguridad, escalabilidad y selecci√≥n de pila tecnol√≥gica para cada unidad.",
                            purpose: "Identificar atributos de calidad y restricciones",
                            executes: "Por unidad, si: Requisitos de rendimiento O consideraciones de seguridad O preocupaciones de escalabilidad O se necesita selecci√≥n de pila tecnol√≥gica",
                            questions: [
                                "¬øCu√°les son los requisitos de rendimiento (latencia, rendimiento)?",
                                "¬øQu√© requisitos de seguridad existen?",
                                "¬øQu√© necesidades de escalabilidad hay?",
                                "¬øQu√© pila tecnol√≥gica debe usarse?",
                                "¬øCu√°les son los requisitos de confiabilidad?"
                            ],
                            outputs: [
                                "{unit-name}/nfr-requirements/performance-requirements.md",
                                "{unit-name}/nfr-requirements/security-requirements.md",
                                "{unit-name}/nfr-requirements/scalability-requirements.md",
                                "{unit-name}/nfr-requirements/tech-stack-selection.md"
                            ]
                        },
                        "nfr-design": {
                            name: "Dise√±o RNF",
                            type: "conditional",
                            description: "Dise√±a patrones y soluciones para cumplir con los requisitos no funcionales. Solo se ejecuta si se ejecutaron los Requisitos RNF.",
                            purpose: "Dise√±ar soluciones para atributos de calidad",
                            executes: "Por unidad, si: Se ejecutaron los Requisitos RNF",
                            questions: [
                                "¬øQu√© patrones abordan los requisitos de rendimiento?",
                                "¬øC√≥mo se implementar√° la seguridad?",
                                "¬øQu√© estrategia de cach√© debe usarse?",
                                "¬øC√≥mo escalar√° el sistema?",
                                "¬øQu√© monitoreo y observabilidad se necesita?"
                            ],
                            outputs: [
                                "{unit-name}/nfr-design/performance-patterns.md",
                                "{unit-name}/nfr-design/security-design.md",
                                "{unit-name}/nfr-design/scalability-design.md",
                                "{unit-name}/nfr-design/monitoring-design.md"
                            ]
                        },
                        "infrastructure-design": {
                            name: "Dise√±o de Infraestructura",
                            type: "conditional",
                            description: "Mapea servicios de infraestructura, define arquitectura de implementaci√≥n y especifica recursos en la nube necesarios para cada unidad.",
                            purpose: "Dise√±ar la infraestructura y estrategia de implementaci√≥n",
                            executes: "Por unidad, si: Los servicios de infraestructura necesitan mapeo O se requiere arquitectura de implementaci√≥n O se necesita especificaci√≥n de recursos en la nube",
                            questions: [
                                "¬øQu√© servicios en la nube se necesitan?",
                                "¬øCu√°l es la arquitectura de implementaci√≥n?",
                                "¬øQu√© infraestructura como c√≥digo se requiere?",
                                "¬øQu√© redes y grupos de seguridad se necesitan?",
                                "¬øCu√°l es la estrategia de recuperaci√≥n ante desastres?"
                            ],
                            outputs: [
                                "{unit-name}/infrastructure-design/cloud-services.md",
                                "{unit-name}/infrastructure-design/deployment-architecture.md",
                                "{unit-name}/infrastructure-design/iac-specifications.md",
                                "{unit-name}/infrastructure-design/network-design.md"
                            ]
                        },
                        "code-generation": {
                            name: "Generaci√≥n de C√≥digo",
                            type: "always",
                            description: "Genera c√≥digo real, pruebas y artefactos para cada unidad. Proceso de dos partes: Planificaci√≥n (crear plan detallado) y Generaci√≥n (ejecutar plan para generar c√≥digo).",
                            purpose: "Generar c√≥digo y pruebas funcionales",
                            executes: "Siempre - Por unidad, para cada unidad de trabajo",
                            unitContext: "Cada unidad implementa un grupo cohesivo de historias de usuario. La generaci√≥n de c√≥digo lee el unit-story-map para comprender qu√© historias implementa esta unidad y genera c√≥digo para cumplir esas historias.",
                            questions: [
                                "¬øQu√© c√≥digo debe generarse?",
                                "¬øCu√°l es la estructura del proyecto?",
                                "¬øQu√© pruebas se necesitan?",
                                "¬øQu√© documentaci√≥n debe crearse?",
                                "¬øQu√© artefactos de implementaci√≥n se requieren?"
                            ],
                            outputs: [
                                "plans/{unit-name}-code-generation-plan.md",
                                "C√≥digo de aplicaci√≥n en la ra√≠z del espacio de trabajo (NO en aidlc-docs/)",
                                "Pruebas unitarias",
                                "Pruebas de integraci√≥n",
                                "{unit-name}/code/code-summary.md",
                                "Documentaci√≥n de API",
                                "Scripts de migraci√≥n de base de datos",
                                "Artefactos de implementaci√≥n"
                            ]
                        },
                        "build-and-test": {
                            name: "Construcci√≥n y Prueba",
                            type: "always",
                            description: "Crea instrucciones completas de construcci√≥n y prueba para todas las unidades. Incluye pruebas unitarias, pruebas de integraci√≥n y pruebas de rendimiento.",
                            purpose: "Proporcionar estrategia completa de prueba y validaci√≥n",
                            executes: "Siempre - Despu√©s de que se completen todas las unidades",
                            questions: [
                                "¬øC√≥mo debe construirse la aplicaci√≥n?",
                                "¬øQu√© pruebas unitarias deben ejecutarse?",
                                "¬øQu√© pruebas de integraci√≥n se necesitan?",
                                "¬øQu√© pruebas de rendimiento deben ejecutarse?",
                                "¬øCu√°l es la secuencia de ejecuci√≥n de pruebas?"
                            ],
                            outputs: [
                                "build-and-test/build-instructions.md",
                                "build-and-test/unit-test-instructions.md",
                                "build-and-test/integration-test-instructions.md",
                                "build-and-test/performance-test-instructions.md",
                                "build-and-test/build-and-test-summary.md"
                            ]
                        }
                    }
                },
                operations: {
                    title: "FASE DE OPERACIONES",
                    color: "#f39c12",
                    flow: "placeholder",
                    flowDescription: "Expansi√≥n futura - incluir√° flujos de trabajo de implementaci√≥n, monitoreo y operaciones.",
                    stages: {
                        "operations": {
                            name: "Operaciones",
                            type: "placeholder",
                            description: "Marcador de posici√≥n para futuros flujos de trabajo de implementaci√≥n y monitoreo. Eventualmente incluir√° planificaci√≥n de implementaci√≥n, configuraci√≥n de monitoreo, respuesta a incidentes y preparaci√≥n para producci√≥n.",
                            purpose: "Implementar y operar el sistema (expansi√≥n futura)",
                            executes: "A√∫n no implementado - Marcador de posici√≥n",
                            questions: [
                                "¬øC√≥mo debe implementarse la aplicaci√≥n?",
                                "¬øQu√© monitoreo y observabilidad se necesita?",
                                "¬øCu√°l es el procedimiento de respuesta a incidentes?",
                                "¬øQu√© actividades de mantenimiento se requieren?",
                                "¬øCu√°les son los criterios de preparaci√≥n para producci√≥n?"
                            ],
                            outputs: [
                                "Futuro: Planes de implementaci√≥n",
                                "Futuro: Configuraciones de monitoreo",
                                "Futuro: Runbooks y procedimientos",
                                "Futuro: Listas de verificaci√≥n de preparaci√≥n para producci√≥n"
                            ]
                        }
                    }
                }
            },
            pt: {
                inception: {
                    title: "FASE DE IN√çCIO",
                    color: "#3498db",
                    flow: "sequential",
                    flowDescription: "Todas as etapas s√£o executadas sequencialmente, uma ap√≥s a outra. Cada etapa deve ser conclu√≠da antes que a pr√≥xima comece.",
                    stages: {
                        "workspace-detection": {
                            name: "Detec√ß√£o de Espa√ßo de Trabalho",
                            type: "always",
                            description: "Detecta se o projeto √© greenfield (novo) ou brownfield (base de c√≥digo existente). Verifica artefatos AI-DLC existentes e determina o ponto de partida.",
                            purpose: "Estabelecer o contexto do projeto e determinar o ponto de entrada do fluxo de trabalho",
                            executes: "Sempre - Primeira etapa de cada fluxo de trabalho",
                            questions: [
                                "Existe c√≥digo no espa√ßo de trabalho?",
                                "H√° artefatos AI-DLC anteriores (aidlc-state.md)?",
                                "Qual √© a estrutura do projeto e a pilha de tecnologia?"
                            ],
                            outputs: [
                                "Classifica√ß√£o do tipo de projeto (greenfield/brownfield)",
                                "Resultados da verifica√ß√£o do espa√ßo de trabalho",
                                "Entrada inicial de audit.md com solicita√ß√£o do usu√°rio",
                                "Decis√£o sobre a pr√≥xima fase (Engenharia Reversa ou An√°lise de Requisitos)"
                            ]
                        },
                        "reverse-engineering": {
                            name: "Engenharia Reversa",
                            type: "conditional",
                            description: "Analisa a base de c√≥digo existente para entender arquitetura, componentes, APIs e pilha de tecnologia. Executa apenas para projetos brownfield sem artefatos de engenharia reversa existentes.",
                            purpose: "Documentar o sistema existente antes de fazer altera√ß√µes",
                            executes: "Somente se: Projeto brownfield E n√£o existem artefatos de engenharia reversa anteriores",
                            questions: [
                                "Quais s√£o as principais transa√ß√µes comerciais?",
                                "Quais componentes e pacotes existem?",
                                "Como os componentes interagem?",
                                "Quais APIs est√£o expostas?",
                                "Qual √© a pilha de tecnologia?"
                            ],
                            outputs: [
                                "architecture.md - Vis√£o geral da arquitetura do sistema",
                                "business-overview.md - Transa√ß√µes comerciais",
                                "code-structure.md - Organiza√ß√£o do c√≥digo",
                                "api-documentation.md - Endpoints de API",
                                "component-inventory.md - Cat√°logo de componentes",
                                "interaction-diagrams.md - Intera√ß√µes de componentes",
                                "technology-stack.md - Detalhes da pilha de tecnologia",
                                "dependencies.md - Gr√°fico de depend√™ncias"
                            ]
                        },
                        "requirements-analysis": {
                            name: "An√°lise de Requisitos",
                            type: "always",
                            description: "Analisa a inten√ß√£o do usu√°rio e coleta requisitos funcionais e n√£o funcionais. A profundidade se adapta com base na clareza e complexidade da solicita√ß√£o (m√≠nima/padr√£o/abrangente).",
                            purpose: "Entender e documentar o que precisa ser constru√≠do",
                            executes: "Sempre - Profundidade adaptativa com base na complexidade",
                            questions: [
                                "O que o usu√°rio est√° tentando alcan√ßar?",
                                "Quais s√£o os requisitos funcionais?",
                                "Quais s√£o os requisitos n√£o funcionais (desempenho, seguran√ßa, escalabilidade)?",
                                "Quais s√£o os crit√©rios de aceita√ß√£o?",
                                "Quais s√£o as restri√ß√µes e suposi√ß√µes?"
                            ],
                            outputs: [
                                "requirement-verification-questions.md - Perguntas de esclarecimento",
                                "requirements.md - Requisitos documentados",
                                "intent-analysis.md - Detalhamento da inten√ß√£o do usu√°rio",
                                "audit.md atualizado com respostas do usu√°rio"
                            ]
                        },
                        "user-stories": {
                            name: "Hist√≥rias de Usu√°rio",
                            type: "conditional",
                            description: "Cria hist√≥rias de usu√°rio e personas quando h√° funcionalidade voltada para o usu√°rio ou requisitos comerciais complexos. Usa an√°lise multifatorial para determinar se as hist√≥rias agregam valor.",
                            purpose: "Definir requisitos centrados no usu√°rio e crit√©rios de aceita√ß√£o",
                            executes: "Se: Recursos voltados para o usu√°rio, l√≥gica comercial complexa ou m√∫ltiplos tipos de usu√°rios envolvidos",
                            questions: [
                                "Quem s√£o os usu√°rios/personas?",
                                "Quais s√£o seus objetivos e pontos de dor?",
                                "Quais jornadas de usu√°rio precisam ser suportadas?",
                                "Quais s√£o os crit√©rios de aceita√ß√£o para cada hist√≥ria?",
                                "Qual √© a prioridade de cada hist√≥ria?"
                            ],
                            outputs: [
                                "user-story-plan.md - Documento de planejamento de hist√≥rias",
                                "personas.md - Personas de usu√°rio",
                                "user-stories.md - Hist√≥rias de usu√°rio completas com crit√©rios de aceita√ß√£o",
                                "story-map.md - Mapeamento e prioriza√ß√£o de hist√≥rias"
                            ]
                        },
                        "workflow-planning": {
                            name: "Planejamento do Fluxo de Trabalho",
                            type: "always",
                            description: "Determina quais fases e etapas ser√£o executadas, em que n√≠vel de profundidade e em que sequ√™ncia. Cria um plano de fluxo de trabalho visual para aprova√ß√£o do usu√°rio.",
                            purpose: "Planejar a estrat√©gia de execu√ß√£o e obter aprova√ß√£o do usu√°rio",
                            executes: "Sempre - Ponto de decis√£o cr√≠tico",
                            questions: [
                                "Quais etapas de Constru√ß√£o s√£o necess√°rias?",
                                "Qual n√≠vel de profundidade para cada etapa (m√≠nima/padr√£o/abrangente)?",
                                "Para brownfield: Quais pacotes alterar e em que ordem?",
                                "Qual √© a estrat√©gia geral de execu√ß√£o?"
                            ],
                            outputs: [
                                "workflow-plan.md - Plano de execu√ß√£o com justificativa",
                                "workflow-visualization.md - Diagrama Mermaid do fluxo de trabalho planejado",
                                "aidlc-state.md atualizado com etapas planejadas"
                            ]
                        },
                        "application-design": {
                            name: "Design de Aplica√ß√£o",
                            type: "conditional",
                            description: "Projeta novos componentes, servi√ßos, m√©todos e regras de neg√≥cio. Define limites e depend√™ncias de componentes.",
                            purpose: "Projetar a arquitetura da aplica√ß√£o e estrutura de componentes",
                            executes: "Se: Novos componentes necess√°rios OU m√©todos de componentes precisam de defini√ß√£o OU design de camada de servi√ßo necess√°rio",
                            questions: [
                                "Quais componentes/servi√ßos s√£o necess√°rios?",
                                "Quais s√£o as responsabilidades dos componentes?",
                                "Quais m√©todos cada componente exp√µe?",
                                "Quais s√£o as depend√™ncias dos componentes?",
                                "Quais regras de neg√≥cio precisam ser implementadas?"
                            ],
                            outputs: [
                                "component-design.md - Especifica√ß√µes de componentes",
                                "service-design.md - Design de camada de servi√ßo",
                                "business-rules.md - Defini√ß√µes de l√≥gica de neg√≥cio",
                                "component-diagram.md - Relacionamentos visuais de componentes"
                            ]
                        },
                        "units-generation": {
                            name: "Gera√ß√£o de Unidades",
                            type: "conditional",
                            description: "Decomp√µe o sistema em m√∫ltiplas unidades de trabalho para desenvolvimento paralelo. Cada unidade √© uma pe√ßa coesa que pode ser desenvolvida independentemente.",
                            purpose: "Dividir sistemas complexos em unidades gerenci√°veis",
                            executes: "Se: M√∫ltiplos servi√ßos/m√≥dulos necess√°rios OU sistema complexo que requer decomposi√ß√£o estruturada",
                            questions: [
                                "Como o sistema deve ser decomposto?",
                                "Quais s√£o os limites das unidades?",
                                "Quais s√£o as depend√™ncias entre unidades?",
                                "Quais hist√≥rias/requisitos cada unidade implementa?",
                                "Qual √© a sequ√™ncia de desenvolvimento?"
                            ],
                            outputs: [
                                "units-plan.md - Estrat√©gia de decomposi√ß√£o de unidades",
                                "unit-definitions.md - Especifica√ß√µes detalhadas de unidades",
                                "unit-dependencies.md - Gr√°fico de depend√™ncias",
                                "unit-story-map.md - Mapeamento de hist√≥ria para unidade"
                            ]
                        }
                    }
                },
                construction: {
                    title: "FASE DE CONSTRU√á√ÉO",
                    color: "#2ecc71",
                    flow: "per-unit-loop",
                    flowDescription: "Executa em um loop por unidade. Cada unidade (que implementa um grupo de hist√≥rias de usu√°rio) passa por todas as etapas de design e gera√ß√£o de c√≥digo antes de passar para a pr√≥xima unidade. Ap√≥s todas as unidades serem conclu√≠das, Build and Test √© executado uma vez.",
                    stages: {
                        "functional-design": {
                            name: "Design Funcional",
                            type: "conditional",
                            description: "Projeta modelos de dados, esquemas e l√≥gica de neg√≥cio detalhada para cada unidade. Executado por unidade no loop de constru√ß√£o.",
                            purpose: "Definir a implementa√ß√£o funcional detalhada",
                            executes: "Por unidade, se: Novos modelos de dados OU l√≥gica de neg√≥cio complexa OU regras de neg√≥cio precisam de design detalhado",
                            questions: [
                                "Quais modelos de dados s√£o necess√°rios?",
                                "Quais s√£o os relacionamentos de entidade?",
                                "Qual l√≥gica de neg√≥cio precisa ser implementada?",
                                "Quais s√£o as regras de valida√ß√£o?",
                                "Quais s√£o os requisitos de transforma√ß√£o de dados?"
                            ],
                            outputs: [
                                "{unit-name}/functional-design/data-models.md",
                                "{unit-name}/functional-design/business-logic.md",
                                "{unit-name}/functional-design/validation-rules.md",
                                "{unit-name}/functional-design/design-decisions.md"
                            ]
                        },
                        "nfr-requirements": {
                            name: "Requisitos RNF",
                            type: "conditional",
                            description: "Avalia requisitos n√£o funcionais incluindo desempenho, seguran√ßa, escalabilidade e sele√ß√£o de pilha de tecnologia para cada unidade.",
                            purpose: "Identificar atributos de qualidade e restri√ß√µes",
                            executes: "Por unidade, se: Requisitos de desempenho OU considera√ß√µes de seguran√ßa OU preocupa√ß√µes de escalabilidade OU sele√ß√£o de pilha de tecnologia necess√°ria",
                            questions: [
                                "Quais s√£o os requisitos de desempenho (lat√™ncia, taxa de transfer√™ncia)?",
                                "Quais requisitos de seguran√ßa existem?",
                                "Quais necessidades de escalabilidade existem?",
                                "Qual pilha de tecnologia deve ser usada?",
                                "Quais s√£o os requisitos de confiabilidade?"
                            ],
                            outputs: [
                                "{unit-name}/nfr-requirements/performance-requirements.md",
                                "{unit-name}/nfr-requirements/security-requirements.md",
                                "{unit-name}/nfr-requirements/scalability-requirements.md",
                                "{unit-name}/nfr-requirements/tech-stack-selection.md"
                            ]
                        },
                        "nfr-design": {
                            name: "Design RNF",
                            type: "conditional",
                            description: "Projeta padr√µes e solu√ß√µes para atender aos requisitos n√£o funcionais. Executa apenas se os Requisitos RNF foram executados.",
                            purpose: "Projetar solu√ß√µes para atributos de qualidade",
                            executes: "Por unidade, se: Requisitos RNF foram executados",
                            questions: [
                                "Quais padr√µes abordam os requisitos de desempenho?",
                                "Como a seguran√ßa ser√° implementada?",
                                "Qual estrat√©gia de cache deve ser usada?",
                                "Como o sistema escalar√°?",
                                "Qual monitoramento e observabilidade s√£o necess√°rios?"
                            ],
                            outputs: [
                                "{unit-name}/nfr-design/performance-patterns.md",
                                "{unit-name}/nfr-design/security-design.md",
                                "{unit-name}/nfr-design/scalability-design.md",
                                "{unit-name}/nfr-design/monitoring-design.md"
                            ]
                        },
                        "infrastructure-design": {
                            name: "Design de Infraestrutura",
                            type: "conditional",
                            description: "Mapeia servi√ßos de infraestrutura, define arquitetura de implanta√ß√£o e especifica recursos de nuvem necess√°rios para cada unidade.",
                            purpose: "Projetar a infraestrutura e estrat√©gia de implanta√ß√£o",
                            executes: "Por unidade, se: Servi√ßos de infraestrutura precisam de mapeamento OU arquitetura de implanta√ß√£o necess√°ria OU especifica√ß√£o de recursos de nuvem necess√°ria",
                            questions: [
                                "Quais servi√ßos de nuvem s√£o necess√°rios?",
                                "Qual √© a arquitetura de implanta√ß√£o?",
                                "Qual infraestrutura como c√≥digo √© necess√°ria?",
                                "Quais redes e grupos de seguran√ßa s√£o necess√°rios?",
                                "Qual √© a estrat√©gia de recupera√ß√£o de desastres?"
                            ],
                            outputs: [
                                "{unit-name}/infrastructure-design/cloud-services.md",
                                "{unit-name}/infrastructure-design/deployment-architecture.md",
                                "{unit-name}/infrastructure-design/iac-specifications.md",
                                "{unit-name}/infrastructure-design/network-design.md"
                            ]
                        },
                        "code-generation": {
                            name: "Gera√ß√£o de C√≥digo",
                            type: "always",
                            description: "Gera c√≥digo real, testes e artefatos para cada unidade. Processo de duas partes: Planejamento (criar plano detalhado) e Gera√ß√£o (executar plano para gerar c√≥digo).",
                            purpose: "Gerar c√≥digo e testes funcionais",
                            executes: "Sempre - Por unidade, para cada unidade de trabalho",
                            unitContext: "Cada unidade implementa um grupo coeso de hist√≥rias de usu√°rio. A gera√ß√£o de c√≥digo l√™ o unit-story-map para entender quais hist√≥rias esta unidade implementa e gera c√≥digo para cumprir essas hist√≥rias.",
                            questions: [
                                "Qual c√≥digo precisa ser gerado?",
                                "Qual √© a estrutura do projeto?",
                                "Quais testes s√£o necess√°rios?",
                                "Qual documenta√ß√£o deve ser criada?",
                                "Quais artefatos de implanta√ß√£o s√£o necess√°rios?"
                            ],
                            outputs: [
                                "plans/{unit-name}-code-generation-plan.md",
                                "C√≥digo da aplica√ß√£o na raiz do espa√ßo de trabalho (N√ÉO em aidlc-docs/)",
                                "Testes unit√°rios",
                                "Testes de integra√ß√£o",
                                "{unit-name}/code/code-summary.md",
                                "Documenta√ß√£o de API",
                                "Scripts de migra√ß√£o de banco de dados",
                                "Artefatos de implanta√ß√£o"
                            ]
                        },
                        "build-and-test": {
                            name: "Constru√ß√£o e Teste",
                            type: "always",
                            description: "Cria instru√ß√µes abrangentes de constru√ß√£o e teste para todas as unidades. Inclui testes unit√°rios, testes de integra√ß√£o e testes de desempenho.",
                            purpose: "Fornecer estrat√©gia completa de teste e valida√ß√£o",
                            executes: "Sempre - Ap√≥s todas as unidades serem conclu√≠das",
                            questions: [
                                "Como a aplica√ß√£o deve ser constru√≠da?",
                                "Quais testes unit√°rios devem ser executados?",
                                "Quais testes de integra√ß√£o s√£o necess√°rios?",
                                "Quais testes de desempenho devem ser executados?",
                                "Qual √© a sequ√™ncia de execu√ß√£o de testes?"
                            ],
                            outputs: [
                                "build-and-test/build-instructions.md",
                                "build-and-test/unit-test-instructions.md",
                                "build-and-test/integration-test-instructions.md",
                                "build-and-test/performance-test-instructions.md",
                                "build-and-test/build-and-test-summary.md"
                            ]
                        }
                    }
                },
                operations: {
                    title: "FASE DE OPERA√á√ïES",
                    color: "#f39c12",
                    flow: "placeholder",
                    flowDescription: "Expans√£o futura - incluir√° fluxos de trabalho de implanta√ß√£o, monitoramento e opera√ß√µes.",
                    stages: {
                        "operations": {
                            name: "Opera√ß√µes",
                            type: "placeholder",
                            description: "Espa√ßo reservado para futuros fluxos de trabalho de implanta√ß√£o e monitoramento. Eventualmente incluir√° planejamento de implanta√ß√£o, configura√ß√£o de monitoramento, resposta a incidentes e prontid√£o para produ√ß√£o.",
                            purpose: "Implantar e operar o sistema (expans√£o futura)",
                            executes: "Ainda n√£o implementado - Espa√ßo reservado",
                            questions: [
                                "Como a aplica√ß√£o deve ser implantada?",
                                "Qual monitoramento e observabilidade s√£o necess√°rios?",
                                "Qual √© o procedimento de resposta a incidentes?",
                                "Quais atividades de manuten√ß√£o s√£o necess√°rias?",
                                "Quais s√£o os crit√©rios de prontid√£o para produ√ß√£o?"
                            ],
                            outputs: [
                                "Futuro: Planos de implanta√ß√£o",
                                "Futuro: Configura√ß√µes de monitoramento",
                                "Futuro: Runbooks e procedimentos",
                                "Futuro: Listas de verifica√ß√£o de prontid√£o para produ√ß√£o"
                            ]
                        }
                    }
                }
            }
        };

        // Dynamic workflow accessor
        let workflow = workflowData.en;

        let currentPhase = null;
        let currentStage = null;

        function showPhase(phase) {
            currentPhase = phase;
            currentStage = null;
            
            // Update phase highlighting
            document.querySelectorAll('.phase').forEach(p => p.classList.remove('active'));
            document.querySelector(`.phase.${phase}`).classList.add('active');
            
            // Show stages
            const stagesContainer = document.getElementById('stages-container');
            const stagesTitle = document.getElementById('stages-title');
            const flowContainer = document.getElementById('flow-diagram-container');
            const stagesDiv = document.getElementById('stages');
            
            stagesTitle.textContent = workflow[phase].title;
            stagesTitle.style.color = workflow[phase].color;
            
            flowContainer.innerHTML = '';
            stagesDiv.innerHTML = '';
            
            // Add flow diagram
            const flowDiagram = createFlowDiagram(phase);
            flowContainer.appendChild(flowDiagram);
            
            // Add section title for stage cards
            const gridTitle = document.createElement('div');
            gridTitle.className = 'stages-grid-title';
            gridTitle.textContent = translations[currentLanguage].clickStage;
            flowContainer.appendChild(gridTitle);
            
            // Add stage cards
            Object.entries(workflow[phase].stages).forEach(([key, stage]) => {
                const stageEl = document.createElement('div');
                stageEl.className = `stage ${stage.type === 'conditional' ? 'conditional' : ''}`;
                stageEl.onclick = () => showStage(phase, key);
                
                const badgeClass = stage.type === 'always' ? 'badge-always' : 
                                   stage.type === 'conditional' ? 'badge-conditional' : 'badge-conditional';
                const badgeText = stage.type === 'always' ? translations[currentLanguage].always : 
                                 stage.type === 'conditional' ? translations[currentLanguage].conditional : translations[currentLanguage].placeholder;
                
                stageEl.innerHTML = `
                    <div class="stage-badge ${badgeClass}">${badgeText}</div>
                    <div class="stage-name">${stage.name}</div>
                    <div class="stage-summary">${stage.description}</div>
                `;
                stagesDiv.appendChild(stageEl);
            });
            
            stagesContainer.classList.add('show');
            document.getElementById('details-panel').classList.remove('show');
        }

        function createFlowDiagram(phase) {
            const container = document.createElement('div');
            container.className = 'flow-diagram';
            const t = translations[currentLanguage];
            
            if (phase === 'inception') {
                container.innerHTML = `
                    <div class="flow-title">${t.flowSequential}</div>
                    <div class="flow-desc">${workflow[phase].flowDescription}</div>
                    <div class="flow-horizontal">
                        <div class="flow-step">
                            <div class="flow-step-title">Workspace Detection</div>
                            <div class="flow-step-desc">${t.always}</div>
                        </div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-step">
                            <div class="flow-step-title">Reverse Engineering</div>
                            <div class="flow-step-desc">${t.ifBrownfield}</div>
                        </div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-step">
                            <div class="flow-step-title">Requirements Analysis</div>
                            <div class="flow-step-desc">${t.always}</div>
                        </div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-step">
                            <div class="flow-step-title">User Stories</div>
                            <div class="flow-step-desc">${t.ifNeeded}</div>
                        </div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-step">
                            <div class="flow-step-title">Workflow Planning</div>
                            <div class="flow-step-desc">${t.always}</div>
                        </div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-step">
                            <div class="flow-step-title">Application Design</div>
                            <div class="flow-step-desc">${t.ifNeeded}</div>
                        </div>
                        <div class="flow-arrow">‚Üí</div>
                        <div class="flow-step">
                            <div class="flow-step-title">Units Generation</div>
                            <div class="flow-step-desc">${t.ifNeeded}</div>
                        </div>
                    </div>
                `;
            } else if (phase === 'construction') {
                container.innerHTML = `
                    <div class="flow-title">${t.flowLoop}</div>
                    <div class="flow-desc">${workflow[phase].flowDescription}</div>
                    <div class="flow-loop">
                        <div class="flow-loop-label">${t.forEachUnit}</div>
                        <div class="flow-unit">
                            <div class="flow-unit-title">${t.exampleUnit}</div>
                            <div style="font-size: 0.85em; color: #666; margin-top: 5px;">
                                ${t.implementsStories}
                            </div>
                        </div>
                        <div class="flow-horizontal">
                            <div class="flow-step">
                                <div class="flow-step-title">Functional Design</div>
                                <div class="flow-step-desc">${t.ifNeeded}</div>
                            </div>
                            <div class="flow-arrow">‚Üí</div>
                            <div class="flow-step">
                                <div class="flow-step-title">NFR Requirements</div>
                                <div class="flow-step-desc">${t.ifNeeded}</div>
                            </div>
                            <div class="flow-arrow">‚Üí</div>
                            <div class="flow-step">
                                <div class="flow-step-title">NFR Design</div>
                                <div class="flow-step-desc">${t.ifNeeded}</div>
                            </div>
                            <div class="flow-arrow">‚Üí</div>
                            <div class="flow-step">
                                <div class="flow-step-title">Infrastructure Design</div>
                                <div class="flow-step-desc">${t.ifNeeded}</div>
                            </div>
                            <div class="flow-arrow">‚Üí</div>
                            <div class="flow-step">
                                <div class="flow-step-title">Code Generation</div>
                                <div class="flow-step-desc">${t.always}</div>
                            </div>
                        </div>
                        <div class="flow-repeat">${t.repeatUnit}</div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <div class="flow-arrow" style="font-size: 2em;">‚Üì</div>
                    </div>
                    <div class="flow-horizontal" style="justify-content: center;">
                        <div class="flow-step" style="min-width: 200px;">
                            <div class="flow-step-title">Build and Test</div>
                            <div class="flow-step-desc">${t.afterUnits}</div>
                        </div>
                    </div>
                `;
            } else if (phase === 'operations') {
                container.innerHTML = `
                    <div class="flow-title">${t.flowPlaceholder}</div>
                    <div class="flow-desc">${workflow[phase].flowDescription}</div>
                    <div class="flow-horizontal" style="justify-content: center;">
                        <div class="flow-step" style="min-width: 200px;">
                            <div class="flow-step-title">Operations</div>
                            <div class="flow-step-desc">${t.notImplemented}</div>
                        </div>
                    </div>
                `;
            }
            
            return container;
        }

        function showStage(phase, stageKey) {
            currentStage = stageKey;
            const stage = workflow[phase].stages[stageKey];
            const t = translations[currentLanguage];
            
            // Update stage highlighting
            document.querySelectorAll('.stage').forEach(s => s.classList.remove('active'));
            event.currentTarget.classList.add('active');
            
            // Show details
            const detailsPanel = document.getElementById('details-panel');
            const detailsContent = document.getElementById('details-content');
            
            // Update back button text
            document.querySelector('.back-btn').textContent = t.backBtn;
            
            const badgeClass = stage.type === 'always' ? 'badge-always' : 
                               stage.type === 'conditional' ? 'badge-conditional' : 'badge-conditional';
            const badgeText = stage.type === 'always' ? translations[currentLanguage].always : 
                             stage.type === 'conditional' ? translations[currentLanguage].conditional : translations[currentLanguage].placeholder;
            
            detailsContent.innerHTML = `
                <div class="details-header">
                    <div class="details-title">${stage.name}</div>
                    <div class="details-meta">
                        <div class="meta-item"><strong>${t.phaseLabel}</strong> ${workflow[phase].title}</div>
                        <div class="meta-item stage-badge ${badgeClass}">${badgeText}</div>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">${t.sectionDescription}</div>
                    <div class="section-content">${stage.description}</div>
                </div>
                
                <div class="section">
                    <div class="section-title">${t.sectionPurpose}</div>
                    <div class="section-content">${stage.purpose}</div>
                </div>
                
                <div class="section">
                    <div class="section-title">${t.sectionCriteria}</div>
                    <div class="section-content">${stage.executes}</div>
                </div>
                
                ${stage.unitContext ? `
                <div class="section">
                    <div class="section-title">${t.sectionUnitStory}</div>
                    <div class="section-content">${stage.unitContext}</div>
                    <div class="example-box">
                        <div class="example-title">${t.exampleUnitStoryTitle}</div>
                        <strong>${t.exampleUnitStoryUnit}</strong> "User Authentication Service"<br>
                        <strong>${t.exampleUnitStoryImplements}</strong>
                        <ul style="margin-top: 8px;">
                            <li>As a user, I want to log in with email/password</li>
                            <li>As a user, I want to reset my forgotten password</li>
                            <li>As a user, I want to stay logged in across sessions</li>
                            <li>As a user, I want to log out securely</li>
                        </ul>
                    </div>
                </div>
                ` : ''}
                
                <div class="section">
                    <div class="section-title">${t.sectionQuestions}</div>
                    <div class="section-content">
                        <ul>
                            ${stage.questions.map(q => `<li>${q}</li>`).join('')}
                        </ul>
                    </div>
                </div>
                
                <div class="section">
                    <div class="section-title">${t.sectionOutputs}</div>
                    <div class="section-content">
                        <ul>
                            ${stage.outputs.map(o => `<li>${o}</li>`).join('')}
                        </ul>
                    </div>
                    <div class="example-box">
                        <div class="example-title">${t.noteFileLocations}</div>
                        ${t.noteFileLocationsText}
                    </div>
                </div>
            `;
            
            detailsPanel.classList.add('show');
            detailsPanel.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }

        function backToStages() {
            document.getElementById('details-panel').classList.remove('show');
            document.querySelectorAll('.stage').forEach(s => s.classList.remove('active'));
            document.querySelector('.back-btn').textContent = translations[currentLanguage].backBtn;
        }

        // Auto-show inception phase on load
        window.onload = () => showPhase('inception');
    </script>
</body>
</html>
